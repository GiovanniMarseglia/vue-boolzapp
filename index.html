<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <!-- icon bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <title>Document</title>
</head>
<body>
    
    <div id="app">
        
        <div class="container-fluid">
            <div class="row d-flex justify-content-center pt-5">
                <!-- blocco di sinistra -->
                <div class="col-2 bg-primary ldiv px-0">
                    <!-- contiene le informazioni del proprietario -->
                    <div class="lprop d-flex align-items-center justify-content-between px-1">
                        <div class="d-flex align-items-center gap-2">
                            <figure class="d-flex align-items-center mb-0">
                                <img src="./img/avatar_io.jpg" alt="personal-profile-picture">
                            </figure>
                            <!-- nome proprietario -->
                            <span>Sofia</span>
                        </div>
                            <!-- icone del proprietario -->
                            <div class="d-flex gap-2 align-items-center fs-6">
                                <i class="bi bi-circle"></i>
                                <i class="bi bi-chat-left-fill"></i>
                                <i class="bi bi-three-dots-vertical"></i>
                            </div>
                           
                    </div>

                    <!-- info per notifiche -->
                    <div class="lnot bg-secondary px-3 d-flex align-items-center gap-2">
                        <i class="bi bi-bell-slash-fill bg-light rounded-5 px-2 py-1 fs-5"></i>
                        <div class="d-flex flex-column infonotifiche "> 
                            <span><strong>Ricevi notifiche di nuovi messaggi</strong></span>
                            <span><u>Attiva notifiche desktop</u></span>
                        </div>
                    </div>




                    <!-- ricerca utenti per nome -->
                    

                        <div class="input-group p-1 ">
                            <span class="input-group-text" id="basic-addon1"><i class="bi bi-search"></i></span>
                            <input type="text" class="form-control" placeholder="Cerca o inizia una nuova chat" aria-label="Username">
                          </div>





                    
                    <!-- card degli utenti -->
                    <div class="overflow-y-scroll scroll">
                        <div  v-for="(element, index) in contacts" class=" d-flex justify-content-between px-2 carduser" @click="posizione=index">
                            <div class="d-flex gap-2">
                                <!-- avatar -->
                                <figure>
                                    <img :src="contacts[index].avatar" alt="">
                                </figure>


                                <!-- nome e ultimo accesso -->
                                <div class="infouser d-flex flex-column">
                                    <span>{{element.name}}</span>
                                    
                                    <span>{{element.messages[element.messages.length-1].message}}</span>
                                </div>
                            </div>

                            <!-- ore in alto a destra -->
                            <div class="lore">
                                <span>{{lstorario(index)}}</span>
                            </div>
                        </div>

                    </div>
                </div>









                <!-- blocco di destra -->
                <div class="col-8 bg-secondary rdiv px-0">
                    <!-- card utente della chat -->
                    <div class="ruser d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <figure class="p-1 mb-0 px-2">
                                <img :src="contacts[posizione].avatar" alt="user-picture">
                            </figure>

                            <!-- nome e accesso -->
                            <div class="d-flex flex-column">
                                <span>{{contacts[posizione].name}}</span>
                                <span>{{ultimoaccesso}}</span>
                            </div>
                        </div>
                        <!-- icone utente chat -->
                        <div class="d-flex gap-3 px-3">
                            <i class="bi bi-search"></i>
                            <i class="bi bi-paperclip"></i>
                            <i class="bi bi-three-dots-vertical"></i>
                        </div>
                    </div>




                    <!-- contenitore con lo spazio per chattare -->
                    <div class="rchat bg-light overflow-y-scroll px-5 pt-4 d-flex flex-column gap-3"  >
                        <div v-for="(element, index) in contacts[posizione].messages" :key="index" >

                            <!-- if else per i messaggi ricevuti o inviati -->
                           <div v-if="element.status==`received`" class="d-flex w-100">
                                <div class="d-flex bg-warning p-2 px-3 rounded" >
                                    <div class="msgdest p-1 px-2 rounded">{{element.message}}</div>
                                    <span class="d-flex align-items-end">{{orario(index)}}</span>
                                </div>
                            </div>

                            <div v-else="element.status==`sent`" class="d-flex justify-content-end w-100">
                                <div class="d-flex bg-success p-2 px-4 rounded gap-2">

                                    <div class="msgmitt">{{element.message}} </div>
                                    <span class="d-flex align-items-end">{{orario(index)}}</span>
                                </div>
                            </div>
 
                        </div>
                            
                        
                        
                    </div>





                    <!-- spazio per scrivere  -->
                    <div class="rinput py-2 px-3 d-flex gap-4 align-items-center">
                        <i class="bi bi-emoji-smile mx-3"></i>
                        <input @keyup.enter="add" v-model="newmessage" class="form-control" type="text" placeholder="Scrivi un messaggio">
                        <i class="bi bi-mic-fill mx-3"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/script" src="luxon.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="./main.js"></script>
</body>
</html>